<html>
<head>

<style type="text/css">
  #sigma-container {
    max-width: 2000px;
    height: 1000px;
    margin: auto;
    background: #3C3C3C;
  }
</style>

</head>
<body>

<div id="sigma-container"></div>
<script src="sigma.min.js"></script>
<script src="sigma.parsers.json.min.js"></script>
<script src="sigma.parsers.gexf.min.js"></script>
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>

<script>

  // Add a method to the graph model that returns an
  // object with every neighbors of a node inside:
  sigma.classes.graph.addMethod('neighbors', function(nodeId) {
    var k,
        neighbors = {},
        index = this.allNeighborsIndex[nodeId] || {};

    for (k in index)
      neighbors[k] = this.nodesIndex[k];

    return neighbors;
  });

   var actualGraph = new sigma();
   
  actualGraph.addRenderer({
  container: document.getElementById('sigma-container'),
  type: 'webgl',
  camera: 'cam1',
  settings: {
    defaultLabelColor: '#fff'
  }
});
  
  //reading the graph file
  
  if (actualGraph) {
        sigma.parsers.gexf( 
            'network_ICASSP2016_10RAGA_2S_11_pattDistance_2s_raga_close_to_sigma_frutcherman_2.gexf',
            actualGraph,
            function(s) {
               s.refresh();                   
            }
        );    
    } else {    
        sigma.parsers.gexf(
            'network_ICASSP2016_10RAGA_2S_11_pattDistance_2s_raga_close_to_sigma_frutcherman_2.gexf',
            {container: 'sigma-container'},
            function(s) {
                actualGraph = s;
            }
        );
    }
    console.log(sigma.settings);
    var settings = new sigma.classes.configurable({
        "labelThreshold": 12,
        "defaultLabelColor": "#FFF",
        "defaultEdgeType": 'curve',
        "zoomingRatio": 10,
        "nodesPowRatio": 2
        });
    actualGraph.settings = settings;
    actualGraph.settings('defaultLabelColor', "#FFF");
  
  
</script>
    <!--<audio id="sample" src="http://dunya.compmusic.upf.edu/document/by-id/2f274b05-9e9e-4faa-a61f-8f5d8cb6f89f.mp3" controls preload></audio>-->
    <audio id = "audioHandle"   preload="auto"></audio>

    <script>
    var audio = document.getElementById('audioHandle');
    var segmentEnd;

    audio.addEventListener('timeupdate', function (){
        if (segmentEnd && audio.currentTime >= segmentEnd) {
            audio.pause();
            document.body.style.cursor = "default";
        }   
        console.log(audio.currentTime);
    }, false);

    function playSegment(mbid, startTime, endTime){
        segmentEnd = endTime;
        audio.src = 'http://dunya.compmusic.upf.edu/document/by-id/' + mbid + '.mp3';
        console.log(audio.src);
        audio.currentTime = startTime;
        audio.play();
    }
</script>

</body>
<html>




<!--    /*ONE WAY TO MAKE AJAX CALLS (WITHOUT JQUERY)*/
//     function createCORSRequest(method, url) {
//     var xhr = new XMLHttpRequest();
//     if ("withCredentials" in xhr) {
//         // XHR for Chrome/Firefox/Opera/Safari.
//         xhr.open(method, url, true);
//     } else if (typeof XDomainRequest != "undefined") {
//         // XDomainRequest for IE.
//         xhr = new XDomainRequest();
//         xhr.open(method, url);
//     } else {
//         // CORS not supported.
//         xhr = null;
//     }
//     return xhr;
//     }
 
//var xmlhttp = new createCORSRequest('GET', "http://127.0.0.1:5000/get_phrase_data?nid=1&format=jsonp&callback?");
//xmlhttp.send()
//xmlhttp.onreadystatechange = function() {
//if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
//    var myArr = JSON.parse(JSON.stringify(xmlhttp.responseText));
    //   console.log(myArr);
//}
//}-->
